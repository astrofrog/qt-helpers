language: c

os:
  - linux

sudo: false

env:
  global:
    - PIP_DEPENDENCIES='pytest-cov coveralls'
    - CONDA_CHANNELS='astrofrog'
    - PYTHON_VERSION=2.7
  matrix:
    - QT_VER="QT4" CONDA_DEPENDENCIES='mock pytest pip coverage pyyaml requests pyqt pyside'
    - QT_VER="QT5" CONDA_DEPENDENCIES='mock pytest pip coverage pyyaml requests pyqt5'

before_install:

  # Install ci-helpers and set up conda
  - git clone git://github.com/astropy/ci-helpers.git
  - source ci-helpers/travis/setup_conda_$TRAVIS_OS_NAME.sh

  # Setup system for headless GUI handling
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start

script:
  - if [ $QT_VER == QT4 ]; then py.test --cov qt_helpers.py test_qt_helpers.py; fi
  - if [ $QT_VER == QT5 ]; then py.test --cov qt_helpers.py test_qt_helpers_qt5.py; fi

after_success:
  - coveralls
